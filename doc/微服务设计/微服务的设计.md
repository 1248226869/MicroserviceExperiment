# 微服务架构{Microservice Architecture}设计
``` 
技术一定是要适合业务和开发者。
飞机的发动机安装到拖拉机上，一定是车毁人亡。
```

## Martin Fowler

##  康威定律（1967年)
* 定义
```
 设计系统的结构，其产生的设计结果等同于团队（项目组）内部的结构以及团队（项目组）之间的沟通结构  
 用通俗的说法就是： 系统设计的架构类似于团队的角色（可兼职，重点是开发的角色定义）结构
```
* 延伸
```


```
## 微服务概念
* 定义
```
微服务架构的设计是将一个系统应用程序根据业务拆分开发为一个小型的、无中心的、只做一件（一类）事情的、独立组件的小型服务的架构设计方法。 
每个小型服务独立中运行、自治（至少是同一台机器的不同进程、可以一同一个机架的不同机器、同一个机房的不同机架上的机器、甚至是不同机房的机器）。
各个小型服务之间轻量级机制（通常是HTTP资源API、RPC，gRPC）进行通信。 
这些服务围绕业务功能构建，可通过全自动部署机制独立部署，可以根据业务流量进行不同的集群部署。 
这些服务保持最低限度的集中式管理。
可以用不同的编程语言编写，并使用不同的数据存储技术。
实现敏捷开发和部署。
```
* 特性
```
100%的组件化（组件是一个可独立替换和升级的业务软件单元。可以快速的、简单的开发、维护与升级）
分布式服务组成的系统
按照业务而不是技术来划分组织
做有生命的产品而不是项目
强服务个体和弱通信
自动化运维（DevOps）
容错、限流
快速演化
```
* 好处
```
1、技术异构性
    根据不同服务的业务中：用户流量、业务复杂度、数据读写频率和存储量采取不同的技术来实现
2、超级弹性
    软件工程中的弹性主要是指某个功能的故障影响到整体系统的使用情况。显然，微服务的 弹性是目前弹性最好的。
3、任意扩张性【永远变化】
4、简单部署性
5、组织相关性
6、简单的可组合性
    公共业务
7、增强的可替代性

```
* 坏处
```
1、网络请求负担
2、去中心化之后各个自治团队能力不均衡
3、学习成本
    微服务的实施会采用新的架构，或者是直接新架构的替换，
    或者是架构的渐进演化，但是都需要参与人员熟悉新架构的使用，
    以及全新的开发模式的适应
```

## 如何构建微服务：一般流程
* 分区（耦合低、内聚高、）
```
    1 确定服务边界 
    2 服务直接的交互规范与协议【rpc？http？grpc?】
    3 
```
* 原则（简单、量少）：
```
    1 整体原则
    2 分区原则
    3 服务原则
```
* 实践：
```
    1 需求驱动发布
    2 测试驱动开发
    3 
```
* 基础设施建设：
```
    1 代码版本控制
    2 自动化构建
    3 流水线发布
    4 持续交付与集成
    5 日志系统
    6 中台组件
    7 监控、报警系统
    8 devops
```
## 系统分解

## 模块集成

## 部署

## 测试

## 监控

### 资源监控

### API监控

### 服务监控

### 用户行为监控

## 安全

## 系统设计

## 模块化微服务

## 微服务的敏捷开发

# 微服务实施

## 前端

## 网关

## 注册中心

## 服务调用

## 全链路追踪

## 持续交付/集成

## devops

## elk

## 测试驱动开发

## 插件式的中间件

# 分布式算法

# 工业级别的Spring cloud构建工具：JHipster